/*! css-clean 2015-11-26 */

function cleanCss(string){var selectorMatch=/([\@\.\%\#\*a-zA-Z0-9\[\]\+\~\=\"\'\_\-\:\&\n,\(\) ]+)\{[\s\S]+\}/;var _=cleanCss.microdash;var cssGroup=[];function getTabspaceLength(){var tabStart=string.match(/(^[ \t]+|;[ \t]+)[a-zA-Z0-9\-\.\#\[\%\@]+/gm);if(tabStart===null){return 2}else if(tabStart.length===1){return tabStart[0].match(/[ \t]+/)[0].length}return tabStart.slice(0,10).reduce(function(a,b){var as=a.match(/[ \t]+/)[0];var bs=b.match(/[ \t]+/)[0];var al=as.length;var bl=bs.length;if(al<bl){return as}else if(bl<al){return bs}return as}).length}function matchLength(s,b){var match=s.match(new RegExp(b,"g"));return!!match?match.length:0}function hasGroup(s){return s.indexOf("{")>-1&&s.indexOf("}")>-1}function contentToArray(cssObj){var longestProperty=0;if(cssObj.content.trim().length){cssObj.content=cssObj.content.replace(/\n[ \t]+/g,"").replace(/((?:\*|)[a-z\-]+)(\s+|):(\s+|)/g,function(m,property){return"\n"+property+":"}).replace(/(@[a-z\-]+)(\s+)/g,function(m,property){return"\n"+property+" "}).trim().split("\n").map(function(m){if(/^@/.test(m)){m=m.replace(/(\s+|);(\s+|)/,"").match(/(@[a-z\-]+)(?:\s+)([\s\S]+)/).slice(1,3)}else{m=m.replace(/(\s+|);(\s+|)/,"").split(":")}if(m[0].length>longestProperty){longestProperty=m[0].length}return{property:m[0],value:m[1],propertyLength:m[0].length}});cssObj.longestProperty=longestProperty}else{cssObj.content=[]}return cssObj}function trimValue(s){var i=0;while(/^(\s+|)\/\/[\s\S]+\n/.test(s)){i=s.indexOf("\n")+1;s=s.substring(i,s.length).replace(/^\s+/g,"")}while(/^(\s+|)\n/.test(s)){i=s.indexOf("\n")+1;s=s.substring(i,s.length).replace(/^\s+/g,"")}while(/^(\s+|)\/\*[\s\S]+?\*\//.test(s)){i=s.indexOf("*/")+2;s=s.substring(i,s.length).replace(/^\s+/g,"")}return s}function getContentAndRemoveComments(value){var start=value.indexOf("{")+1;var end=value.lastIndexOf("}");var string=value.substring(start,end);return string.replace(/\/\/[^\n]+?\n|\/\*[\s\S]+?\*\//g,"")}function getSelectorAndConvertToList(value){return value.match(selectorMatch)[1].split(",").map(function(a){return a.trim()})}function getGroup(string,_cssGroup_,tabLength){var cssObj={};var value;var open;var closed;var groups;for(var i=0,n=string.length;i<=n;i++){value=string.substring(0,i);open=matchLength(value,"{");closed=matchLength(value,"}");if(open===closed&&open>0){value=trimValue(value);cssObj={value:value.match(selectorMatch)[0].trim(),content:getContentAndRemoveComments(value),selector:getSelectorAndConvertToList(value),tabLength:tabLength,tabs:/^\t/m.test(value)};if(hasGroup(cssObj.content)){cssObj.child=[];groups=getGroup(cssObj.content,cssObj.child,tabLength+2);groups.forEach(function(group){cssObj.content=cssObj.content.replace(group.value,"").replace(/\n[ \t]+\n/g,"\n")})}_cssGroup_.push(contentToArray(cssObj));if(hasGroup(string)){getGroup(string.substring(i,string.length),_cssGroup_,tabLength)}i=n}}return _cssGroup_}cssGroup.string=string;return cleanCss.fn(getGroup(string,cssGroup,getTabspaceLength()))}cleanCss.fn=function(array){for(var k in cleanCss.fn){array[k]=function(k){return function(){return cleanCss.fn[k].apply(array,arguments)}}(k)}return array};cleanCss.microdash={};cleanCss.microdash.chain=function(array,functionList){for(var k in functionList){array[k]=function(k){return function(){var _arguments_=[array].concat([].slice.call(arguments));return functionList[k].apply(null,_arguments_)}}(k)}return array};cleanCss.microdash.indexesOf=function(array,value){var index=[];while(array.indexOf(value)>-1){index.push(array.indexOf(value));array=array.slice(array.indexOf(value)+1,array.length)}return index};cleanCss.microdash.chunk=function(array,chunkN){var chunk=[];for(var i=0,n=array.length;i<n;i+=chunkN){chunk.push(array.slice(i,i+chunkN))}return cleanCss.microdash.chain(chunk,cleanCss.microdash)};cleanCss.microdash.sum=function(array){return array.reduce(function(a,b){return a+b})};cleanCss.microdash.average=function(array){return cleanCss.microdash.sum(array)/array.length};(function(){function alignProperties(array){array.forEach(function(cssObject,i){cssObject.content=cssObject.content.map(function(value){var length=cssObject.longestProperty-value.propertyLength;value.property=value.property+new Array(length+2).join(" ");return value});if(Array.isArray(cssObject.child)){alignProperties(cssObject.child)}})}cleanCss.fn.alignProperties=function(){alignProperties(this);return this}})();(function(){var sortOrder=["@extend","@include","z-index","content","display","*display","visibility","appearance","-moz-appearance","-ms-appearance","-webkit-appearance","zoom","position","top","right","bottom","left","width","height","float","clear","margin","margin-top","margin-right","margin-bottom","margin-left","padding","padding-top","padding-right","padding-bottom","padding-left","max-width","max-height","min-width","min-height","color","list-style","list-style-image","list-style-position","list-style-type","counter-increment","counter-reset","border","border-top","border-right","border-bottom","border-left","border-color","border-image","border-image-source","border-image-repeat","border-image-width","border-image-outset","border-image-slice","border-top-color","border-right-color","border-bottom-color","border-left-color","border-size","border-style","border-radius","border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius","border-collapse","border-spacing","outline","outline-color","outline-offset","outline-style","outline-width","caption-side","empty-cells","table-layout","text-align","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-underline-position","text-transform","text-shadow","text-overflow","vertical-align","font","font-family","font-size","font-size-adjust","font-style","font-weight","font-kerning","font-stretch","line-height","letter-spacing","word-spacing","line-break","hyphens","overflow-wrap","tab-size","white-space","word-break","word-wrap","box-shadow","-moz-box-shadow","-ms-box-shadow","-webkit-box-shadow","box-decoration-break","opacity","filter","overflow","overflow-x","overflow-y","background","background-image","background-color","background-blend-mode","background-repeat","background-attachment","background-origin","background-position","background-size","background-clip","user-select","-moz-user-select","-ms-user-select","-webkit-user-select","pointer-events","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","transition","-moz-transition","-ms-transition","-webkit-transition","transition-property","transition-duration","transition-timing-function","transition-delay","transform","-moz-transform","-ms-transform","-webkit-transform","cursor","resize"];function sortContent(array){array.forEach(function(cssObject,i){cssObject.content=cssObject.content.sort(function(a,b){var bI=sortOrder.indexOf(b.property)<0;var aI=sortOrder.indexOf(a.property)<0;if(!aI&&!bI){return sortOrder.indexOf(a.property)-sortOrder.indexOf(b.property)}else if(!aI&&bI){return-1}return 1});if(Array.isArray(cssObject.child)){sortContent(cssObject.child)}});return array}cleanCss.fn.sortContent=function(){return sortContent(this)}})();(function(){var fill={selector:"@tabLength@selector",group:"@selector {\n@content@tabLength}\n",content:"@tabLength@property: @value;\n",sass:"@tabLength@property  @value;\n"};var _=cleanCss.microdash;function template(string,object){return string.replace(/@([a-zA-Z]+)/g,function(m,property){return typeof object[property]==="string"?object[property]:""})}function toSelector(selector,tabLength){var out;if(/@media/.test(selector.join(""))){out=selector.join(",\n")}else{var longest=selector.map(function(a){return a.length}).sort(function(a,b){return a-b}).slice(-1)[0];if(longest<10){out=_.chunk(selector.sort(),Math.ceil(20/longest)).map(function(selectors){return template(fill.selector,{selector:selectors.join(", "),tabLength:tabLength})}).join(",\n")}else{out=selector.sort().map(function(selector){return template(fill.selector,{selector:selector,tabLength:tabLength})}).join(",\n")}}return out}function convertToString(cssGroups,tabLength){var convertedGroup=[];tabLength=tabLength||0;cssGroups.forEach(function(group){var content=[];var tabChar=group.tabs?"	":" ";group.content.forEach(function(groupContent){if(/^@/.test(groupContent.property)){content.push(template(fill.sass,{property:groupContent.property,value:groupContent.value,tabLength:new Array(group.tabLength+1).join(tabChar)}))}else{content.push(template(fill.content,{property:groupContent.property,value:groupContent.value,tabLength:new Array(group.tabLength+1).join(tabChar)}))}});if(Array.isArray(group.child)){content.push(convertToString(group.child,group.tabLength).join(""))}convertedGroup.push(template(fill.group,{selector:toSelector(group.selector,new Array(tabLength+1).join(tabChar)),content:content.join(""),tabLength:new Array(tabLength+1).join(" ")}))});return convertedGroup}cleanCss.fn.value=function(){var converted=convertToString(this);var self=this;self.forEach(function(m,i){self.string=self.string.replace(m.value,converted[i].trim())});return self.string}})();cleanCss.sortWith=function(array,sourceArray){return array.sort(function(a,b){var bOut=sourceArray.indexOf(b)<0;var aOut=sourceArray.indexOf(a)<0;if(!aOut&&!bOut){return sourceArray.indexOf(a)-sourceArray.indexOf(b)}else if(!aOut&&bOut){return-1}return 1})};(function(){module.exports={activate:function(state){atom.commands.add("atom-text-editor",{"css-clean:convert":this.convert})},convert:function(event){var editor=this.getModel();var editorText=editor.getText();var selectedBuffer=editor.getSelectedBufferRange();var clean;if(/^source\.css/.test(editor.getRootScopeDescriptor().scopes[0])){clean=cleanCss(editorText).sortContent().alignProperties().value();editor.setText(clean);editor.setSelectedBufferRange(selectedBuffer)}}}})();
//# sourceMappingURL=css-clean.js.map